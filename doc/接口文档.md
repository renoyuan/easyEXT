# 1 web调用接口

## 1.1 获取token

#### 接口url

{{ip}}:{{port}}/exuser/user/login?account=yss001&password=e10adc3949ba59abbe56e057f20f883

**请求方式  POST**



#### 入参 params

| 名称     | 类型   | 是否必传 | 备注        |
| -------- | ------ | -------- | ----------- |
| account  | String | 是       | 账号        |
| password | String | 否       | 密码md5加密 |



#### 返回参数

| 名称    | 类型   | 是否必传 | 备注         |
| ------- | ------ | -------- | ------------ |
| taskSns | String | 是       | 任务id       |
| code    | String | 是       | 状态码       |
| status  | int    | 是       | 当前任务状态 |

##### 样例

```json
{
   "code": "200",
   "message": "操作成功！",
   "data": {
     "token": "eyJhbGciOiJIUzI1NiJ9"

 },
   "status": 1
}
```

## 1.2 当前用户信息

返回 场景 权限等

## 1.3 任务清单

分页 查询

## 1.4 任务详情查看

## 1.4 任务信息更改



## 1.2 上传ocr任务

#### 接口url

{{ip}}:{{port}}/extask/ocr/

**请求方式  POST**



#### 入参 params

| 名称     | 类型   | 是否必传 | 备注        |
| -------- | ------ | -------- | ----------- |
| account  | String | 是       | 账号        |
| password | String | 否       | 密码md5加密 |



#### 返回参数

样例



## 1.3 上传表格任务

#### 接口url

{{ip}}:{{port}}/extask/ocr/

**请求方式  POST**



#### 入参 params

| 名称     | 类型   | 是否必传 | 备注        |
| -------- | ------ | -------- | ----------- |
| account  | String | 是       | 账号        |
| password | String | 否       | 密码md5加密 |



#### 返回参数

样例

## 1.4 上传抽取任务

#### 接口url

{{ip}}:{{port}}/extask/ocr/

**请求方式  POST**



#### 入参 params

| 名称     | 类型   | 是否必传 | 备注        |
| -------- | ------ | -------- | ----------- |
| account  | String | 是       | 账号        |
| password | String | 否       | 密码md5加密 |



#### 返回参数

样例



## 1.5 上传抽取任务

#### 接口url

{{ip}}:{{port}}/extask/ocr/

**请求方式  POST**



#### 入参 params

| 名称     | 类型   | 是否必传 | 备注        |
| -------- | ------ | -------- | ----------- |
| account  | String | 是       | 账号        |
| password | String | 否       | 密码md5加密 |



#### 返回参数

样例



------



# 2 外部调用接口





## 2.1 获取token

#### 接口url

{{ip}}:{{port}}/exuser/user/login?account=yss001&password=e10adc3949ba59abbe56e057f20f883

**请求方式  POST**



#### 入参 params

| 名称     | 类型   | 是否必传 | 备注        |
| -------- | ------ | -------- | ----------- |
| account  | String | 是       | 账号        |
| password | String | 否       | 密码md5加密 |



#### 返回参数

| 名称    | 类型   | 是否必传 | 备注         |
| ------- | ------ | -------- | ------------ |
| taskSns | String | 是       | 任务id       |
| code    | String | 是       | 状态码       |
| status  | int    | 是       | 当前任务状态 |

##### 样例

```json
{
   "code": "200",
   "message": "操作成功！",
   "data": {
     "token": "eyJhbGciOiJIUzI1NiJ9"

 },
   "status": 1
}
```





##### 





## 2.2 外部要素抽取-上传任务

非pdf文件不支持拆分，pageNumber参数为0

#### 接口url

{{ip}}:{{port}}/draw/draw/doExtract?templateId=r-BILL&pageNumber=0&needMerge=0&rotate=1  

**请求方式  POST**

#### 输入参数-parms

| 名称        | 类型   | 是否必传 | 备注                                     |      |      |
| ----------- | ------ | -------- | ---------------------------------------- | ---- | ---- |
| templateId  | String | 是       | 场景id                                   |      |      |
| pageNumber  | Int    | 否       | 是否分页拆分；例0:不拆分，2:每两页拆分   |      |      |
| needMerge   | Int    | 是       | 文件是否独立抽取；0:独立抽取，1:合并抽取 |      |      |
| rotate      | Int    | 是       | 文件是否旋转；0:不旋转，1:旋转           |      |      |
| sealErasure | Int    | 否       | 印章擦除；0:不擦除，1:擦除               |      |      |

#### 输入参数-form

| 名称          | 类型            | 是否必传 | 备注       |
| ------------- | --------------- | -------- | ---------- |
| originalFiles | MultipartFile[] | 是       | 文件流数组 |













#### 返回参数

| 名称    | 类型   | 是否必传 | 备注         |
| ------- | ------ | -------- | ------------ |
| taskSns | String | 是       | 任务id       |
| code    | String | 是       | 状态码       |
| status  | int    | 是       | 当前任务状态 |



##### 样例

```json
{
   "code": "200",
   "message": "操作成功！",
   "data": {
     "taskSns": [‘963449428587446272’]
   },
   "status": 1
}
```



## 2.3外部要素抽取-结果查询

#### 接口url

{{ip}}:{{port}}/data/review/getExtractResult?taskSn=1140595455919521792  

**请求方式  GET**

#### 输入参数-parms

| 名称   | 类型   | 是否必传 | 备注   |
| ------ | ------ | -------- | ------ |
| taskSn | String | 是       | 任务id |

 

 

#### 返回参数

| 名称       | 类型       | 是否必传 | 备注         |
| ---------- | ---------- | -------- | ------------ |
| taskSns    | String     | 是       | 任务id       |
| code       | String     | 是       | 状态码       |
| taskStatus | int        | 是       | 任务状态     |
| totalPage  | int        | 是       | 文件数量     |
| dataGroup  | list[dict] | 是       | 抽取结果list |
|            |            |          |              |



##### 样例

```json
{
   "code": "200",
   "message": "操作成功！",
   "data": {
     "taskSn": "1143234910333566976",      //任务id
     "templateId": "10001",           //场景id
     "taskStatus": 1,              //0:任务进行中；1：任务成功；2：任务失败

 "totalPage": 2,              //图片total
     "dataGroup": [
       {
         "证券代码": {            //要素名
           "elementValue": "200010CUAM",      //要素值
           "objPosList": [         //文本框坐标
             [
               30,      //y坐标
               38,      //x坐标
               13,      //h坐标
               37,      //w坐标
               [
                 4.8791208791208796,      //文本框内每个字符x轴偏移量数组
                 9.758241758241759,
                 16.263736263736263,
                 22.142857142857142,
                 27.64835164835165,
                 32.527472527472526
               ]
             ],
             [
               42,
               434,
               9,
               35,
               [
                 4.516129032258065,
                 12.419354838709678,
                 22.451612903225808,
                 27.09677419354839
               ]
             ]
           ],
           "page": 0          //要素所在页码
         },
         "业务类型": {
           "elementValue": "",
           "objPosList": [],
           "page": null
         },
         "产品名称": {
           "elementValue": "招行中国银联股份有限公司企业年金计划博时",
           "objPosList": [
             [
               87,
               41,
               12,
               266,
               [
                 3.0014104372355432,
                 15.007052186177717,
                 25.511988716502117,
                 37.51763046544429,
                 48.02256699576869,
                 58.52750352609309,
                 70.53314527503527,
                 82.03808180535967,
                 93.04372355430183,
                 102.04795486600847,
                 117.05500705218618,
                 126.05923836389282,
                 138.064880112835,
                 148.56981664315938,
                 159.0747531734838,
                 172.58110014104375,
                 183.08603667136813,
                 193.59097320169255,
                 204.09590973201693,
                 214.60084626234135,
                 228.1071932299013,
                 238.61212976022568,
                 249.1170662905501,
                 262.12270803949224
               ]
             ]
           ],
           "page": 0
         }
       }
     ]
   },
   "status": 1
}
```





 





## 2.4.外部OCR识别-上传

#### 接口url

{{ip}}:{{port}}/draw/draw/doOCR?sealErasure=1&rotate=1   

**请求方式  POST**

#### 输入参数-parms

| 名称        | 类型 | 是否必传 | 备注                           |
| ----------- | ---- | -------- | ------------------------------ |
| rotate      | Int  | 是       | 文件是否旋转；0:不旋转，1:旋转 |
| sealErasure | Int  | 否       | 印章擦除；0:不擦除，1:擦除     |
|             |      |          |                                |
|             |      |          |                                |

####  输入参数-form

| 名称          | 类型            | 是否必传 | 备注       |
| ------------- | --------------- | -------- | ---------- |
| originalFiles | MultipartFile[] | 是       | 文件流数组 |



#### 返回参数

| 名称    | 类型   | 是否必传 | 备注   |
| ------- | ------ | -------- | ------ |
| taskSns | String | 是       | 任务id |
| code    | String | 是       | 状态码 |
|         |        |          |        |
|         |        |          |        |



##### 样例

```json
{
   "code": "200",
   "message": "操作成功！",
   "data": {
     "taskSns": [‘963449428587446272_2’,’963449428587445555_2’]
   },
   "status": 1
}
```



### 2.5 外部ocr识别-结果查询

#### 接口url

{{ip}}:{{port}}/draw/fileTask/getOcrResult?taskSn=1140595455919521792 

**请求方式   GET**

#### 输入参数-parms

| 名称   | 类型 | 是否必传 | 备注   |
| ------ | ---- | -------- | ------ |
| taskSn | str  | 是       | 任务id |
|        |      |          |        |

#### 

#### 返回参数

| 名称       | 类型       | 是否必传 | 备注     |
| ---------- | ---------- | -------- | -------- |
| taskSns    | String     | 是       | 任务id   |
| code       | String     | 是       | 状态码   |
| taskStatus | int        | 是       | 任务状态 |
| totalPage  | int        | 是       | 图片数量 |
| pageJson   | list[dict] | 是       | 识别结果 |



##### 样例

```
{
   "code": "200",
   "message": "操作成功！",
   "status": 1,
   "data": {
     "taskSn": "1140595455919521792", //任务id
     "taskStatus": 0, //0:任务进行中；1：任务成功；2：任务失败
     "totalPage": 2, //图片total
     "pageJson": [
       {
         "pageEndIndex": 678,
         "docId": "v1_rBIHD2TcKkeAWYzYAAJ8yZadNio160_0_9iecywch136e",
         "pageNo": 0, //页码
         "pageStartIndex": 0,
         "paragraphs": [
           {
             "paraId": "0",
             "paraNo": 0,
             "lines": [
               {
                 "sortNo": 0,
                 "rowNo": 9223372036854775807,
                 "lineNo": 0, //行数
                 "lineEndIndex": 5,
                 "objContent": "交易对账单", //文本框内容
                 "lineStartIndex": 0,
                 "lineId": "line_0_0_9kecywchb300", //行坐标id
                 "objPos": [ //文本框
                   122.92713753280343, //y坐标
                   513.6119859959996, //x坐标
                   34.14360818101535, //h坐标
                   162.03026599075076, //w坐标
                   [ //文本框内每个字符x轴偏移量数组
                     12.79710723105304,
                     46.92272651386114,
                     76.78264338631823,
                     106.64256025877532,
                     140.7681795415834
                   ]
                 ],
                 "objType": "textLine", //内容类型；textLine-文本；table-表格
                 "objType_postpreprocess": "text_postpreprocess"
               },
               {
                 "sortNo": 2,
                 "lineEndIndex": 14175,
                 "lineNo": 60,
                 "objContent": "[{\"sortNo\":2,\"rowNo\":0,\"lineNo\":2,\"objContent\":\"客户名称：\"}]",//表格详细信息
                 "lineStartIndex": 9643,
                 "lineId": "line_0_60_1dScOwik44ae",
                 "objPos": [
                   181,
                   205,
                   320,
                   1217
                 ],
                 "objType": "table", //表格
                 "table": [    //表格下单元格识别信息
                   {
                     "sortNo": 2,
                     "rowNo": "0", //表格行序号，0开始
                     "lineEndIndex": 0,
                     "lineNo": 2,
                     "objContent": "客户名称：", //识别内容
                     "lineStartIndex": 0,
                     "lineId": "line_0_2_1hScOwik3c01",
                     "objPos": [ //单元格坐标
                       192, //y坐标
                       210, //x坐标
                       28, //h坐标
                       120, //w坐标
                       [ //字符偏移量
                         10.51094890510949,
                         35.03649635036496,
                         63.065693430656935,
                         87.59124087591242,
                         112.11678832116789
                       ]
                     ],
                     "objType": "textLine"
                   }
                 ]
               }
             ]
           }
         ]
       }
     ]
   }
}
```





## 2.4外部表格识别-上传

#### 接口名称

119.23.70.60:9020/draw/draw/checkTable         POST

#### 入参Body

| 名称          | 类型            | 是否必传 | 备注                           |
| ------------- | --------------- | -------- | ------------------------------ |
| originalFiles | MultipartFile[] | 是       | 文件流数组                     |
| rotate        | Int             | 是       | 文件是否旋转；0:不旋转，1:旋转 |

#### 返回结果

##### 成功


{
   "code": "200",
   "message": "操作成功！",
   "data": {
     "taskSns": [‘963449428587446272_3’,’963449428587445555_3’]
   },
   "status": 1
}

##### 失败


{
   "code": "601",
   "message": "抱歉，系统出现异常！",
   "status": 0
}

### **4.2****外部****表格识别结果查询**

#### 接口名称

119.23.70.60:9020/draw/fileTask/getTableResult?taskSn=1140595455919521792  GET

#### 入参Body

| 名称   | 类型   | 是否必传 | 备注   |
| ------ | ------ | -------- | ------ |
| taskSn | String | 是       | 任务id |

 

#### 返回结果

##### 成功

{
   "code": "200",
   "message": "操作成功！",
   "status": 1,
   "data": {
     "taskSn": "1140595455919521792", //任务id
     "taskStatus": 0, //0:任务进行中；1：任务成功；2：任务失败
     "totalPage": 2, //图片total
     "pageJson": [
       {
         "pageEndIndex": 678,
         "docId": "v1_rBIHD2TcKkeAWYzYAAJ8yZadNio160_0_9iecywch136e",
         "pageNo": 0, //页码
         "pageStartIndex": 0,
         "paragraphs": [ //段落
           {
             "paraId": "0",
             "paraNo": 0,
             "lines": [
               {
                 "table": [ //表格
                   {
                     "sortNo": 1,
                     "rowNo": 0, //表格行序号，0开始
                     "lineNo": 1, //单元格序号，1开始
                     "objContent": "客户名称", //识别内容 
                     "lineId": "line_0_1_Q8mcpwcheb10", //单元格坐标id
                     "objType": "textLine",
                     "objPos": [ //单元格坐标
                       124, //y坐标
                       153, //x坐标
                       28, //h坐标
                       94, //w坐标
                       [ //字符偏移量
                         10.542056074766355,
                         32.626168224299064,
                         56.22429906542056,
                         77.30841121495327
                       ]
                     ]
                   },
                   {
                     "sortNo": 1,
                     "rowNo": 0,
                     "lineNo": 2,
                     "objContent": "博时基金集合资产管理计划",
                     "lineId": "line_0_2_Q9mcpwchee8e",
                     "objType": "textLine",
                     "objPos": [
                       124,
                       378,
                       27,
                       268,
                       [
                         6.763406940063091,
                         27.053627760252365,
                         54.10725552050473,
                         74.397476340694,
                         94.68769716088327,
                         122.74132492113564,
                         142.03154574132492,
                         162.32176656151418,
                         185.993690851735,
                         206.28391167192427,
                         229.9558359621451,
                         253.62776025236593
                       ]
                     ]
                   }
                 ],
                 "objPos": [ //表格坐标
                   118,
                   144,
                   703,
                   905
                 ],
                 "objType": "table" // 文本类型
               }
             ]
           }
         ]
       }
     ]
   }
}

 

##### 失败


{
   "code": "601",
   "message": "抱歉，系统出现异常！",
   "status": 0
}

 

 

## **5.** 外部印章识别

### **5.1上传**

#### 接口名称

119.23.70.60:9020/draw/draw/recognizeSeal     POST

#### 入参Body

| 名称          | 类型            | 是否必传 | 备注       |
| ------------- | --------------- | -------- | ---------- |
| originalFiles | MultipartFile[] | 是       | 文件流数组 |

#### 返回结果

##### 成功


{
   "code": "200",
   "message": "操作成功！",
   "data": {
     "taskSns": [‘963449428587446272’,’963449428587445555’]
   },
   "status": 1
}

##### 失败


{
   "code": "601",
   "message": "抱歉，系统出现异常！",
   "status": 0
}

### **5.2****外部****印章识别结果查询**

#### 接口名称

119.23.70.60:9020/draw/fileTask/getRecognizeSealResult?taskSn=1140595455919521792  GET

 

| 名称   | 类型   | 是否必传 | 备注   |
| ------ | ------ | -------- | ------ |
| taskSn | String | 是       | 任务id |

 

#### 返回结果

##### 成功

{
   "code": "200",
   "message": "操作成功！",
   "data": {
     "taskStatus": 1,

 "totalPage": 2,              //图片total
     "pageJsons": [
       {
         "seal_info": [
           {
             "pos": {
               "sw": 0.18,
               "sh": 0.12,
               "sx": 0.72,
               "sy": 0.79
             },
             "text": [
               "汇泰鑫基金普理股份有限公司"
             ],

  "labels": [
               "0"      //公章类型（1:圆章，2:方章，3:椭圆章，4:菱形章）
             ]
           }
         ],
         "paraNo": "0"
       }
     ]
   },
   "status": 1
}

##### 失败


{
   "code": "601",
   "message": "抱歉，系统出现异常！",
   "status": 0
}

 

## **6.** 获取图片数据

#### 接口名称

119.23.70.60:9020/draw/picParentTaskSnPageBatch?taskSn=1141391308527632384  POST

 

| 名称   | 类型          | 是否必传 | 备注                     |
| ------ | ------------- | -------- | ------------------------ |
| taskSn | String        | 是       | 任务id                   |
| pages  | List<Integer> | 是       | 图片页码集合(ruqestBody) |

 

#### 返回结果

##### 成功

{
   "code": "200",
   "message": "操作成功！",
   "data": {
     "0": {    //图片页码
       "base64":"01izb8DAAAAAElFTkSu",
       "width": 1190,
       "height": 1683,
       "pageNo": null
     }
   },
   "status": 1
}

##### 失败


{
   "code": "601",
   "message": "抱歉，系统出现异常！",
   "status": 0
}

 

 

# 2 内部调用接口

## 1 场景获取

## 2 用户信息获取

## 3 用户任务获取

按时间顺序分页

## 4 任务详情

任务结果修改

 

# 3.相关信息

### 3.1场景映射

| 场景名称 | 场景Id |
| -------- | ------ |
| 申购申请 | 10001  |
| 申购确认 | 10002  |
| 赎回确认 | 10003  |
| 认购确认 | 10004  |

 

### 3.2错误码

 

| 操作是否成功/success | 操作代码/code | 提示信息/message                    | 状态/status |
| -------------------- | ------------- | ----------------------------------- | ----------- |
| TRUE                 | 200           | 操作成功                            | 1           |
| FALSE                | 601           | 操作失败！                          | 0           |
| FALSE                | 602           | 非法参数！                          | 0           |
| FALSE                | 603           | 必要参数不能为空                    | 0           |
| FALSE                | 604           | 此操作需要登陆系统！                | 0           |
| FALSE                | 605           | 权限不足，无权操作！                | 0           |
| FALSE                | 606           | 新增失败                            | 0           |
| FALSE                | 607           | 删除失败                            | 0           |
| FALSE                | 608           | 修改失败                            | 0           |
| FALSE                | 609           | 该记录关键字段已经存在              | 0           |
| FALSE                | 610           | id不能为空！                        | 0           |
| FALSE                | 611           | 无查询结果!                         | 0           |
| FALSE                | 612           | 未找到路径                          | 0           |
| FALSE                | 613           | 当前用户无操作权限                  | 0           |
| FALSE                | 601           | 抱歉，系统出现异常！                | 0           |
| FALSE                | 602           | 抱歉，系统繁忙！                    | 0           |
| FALSE                | 614           | 仅支持pdf文件拆分，请检查文件类型！ | 0           |
| 小写                 |               |                                     |             |

 

 

Postman接口调用json：

![img](file:///C:\Users\renoy\AppData\Local\Temp\ksohtml25552\wps2.png)